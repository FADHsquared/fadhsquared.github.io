import{b as m,K as k,l as y,u as _,a as V,h as C}from"./index-B6q3_By8.js";var b=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,i)=>(typeof require<"u"?require:n)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function z(e){const[n,i]=m(),l=e?.throw?(t,r)=>{throw i(t instanceof Error?t:new Error(r)),t}:(t,r)=>{i(t instanceof Error?t:new Error(r))},c=e?.api?Array.isArray(e.api)?e.api:[e.api]:[globalThis.localStorage].filter(Boolean),u=e?.prefix?`${e.prefix}.`:"",h=new Map,v=new Proxy({},{get(t,r){let a=h.get(r);a||(a=m(void 0,{equals:!1}),h.set(r,a)),a[0]();const o=c.reduce((s,f)=>{if(s!==null||!f)return s;try{return f.getItem(`${u}${r}`)}catch(d){return l(d,`Error reading ${u}${r} from ${f.name}`),null}},null);return o!==null&&e?.deserializer?e.deserializer(o,r,e.options):o}}),S=(t,r,a)=>{const o=e?.serializer?e.serializer(r,t,a??e.options):r,s=`${u}${t}`;c.forEach(d=>{try{d.getItem(s)!==o&&d.setItem(s,o)}catch(q){l(q,`Error setting ${u}${t} to ${o} in ${d.name}`)}});const f=h.get(t);f&&f[1]()},x=t=>c.forEach(r=>{try{r.removeItem(`${u}${t}`)}catch(a){l(a,`Error removing ${u}${t} from ${r.name}`)}}),I=()=>c.forEach(t=>{try{t.clear()}catch(r){l(r,`Error clearing ${t.name}`)}}),L=()=>{const t={},r=(a,o)=>{if(!t.hasOwnProperty(a)){const s=o&&e?.deserializer?e.deserializer(o,a,e.options):o;s&&(t[a]=s)}};return c.forEach(a=>{if(typeof a.getAll=="function"){let o;try{o=a.getAll()}catch(s){l(s,`Error getting all values from in ${a.name}`)}for(const s of o)r(s,o[s])}else{let o=0,s;try{for(;s=a.key(o++);)t.hasOwnProperty(s)||r(s,a.getItem(s))}catch(f){l(f,`Error getting all values from ${a.name}`)}}}),t};return e?.sync!==!1&&k(()=>{const t=r=>{let a=!1;c.forEach(o=>{try{o!==r.storageArea&&r.key&&r.newValue!==o.getItem(r.key)&&(r.newValue?o.setItem(r.key,r.newValue):o.removeItem(r.key),a=!0)}catch(s){l(s,`Error synching api ${o.name} from storage event (${r.key}=${r.newValue})`)}}),a&&r.key&&h.get(r.key)?.[1]()};"addEventListener"in globalThis?(globalThis.addEventListener("storage",t),y(()=>globalThis.removeEventListener("storage",t))):(c.forEach(r=>r.addEventListener?.("storage",t)),y(()=>c.forEach(r=>r.removeEventListener?.("storage",t))))}),[v,S,{clear:I,error:n,remove:x,toJSON:L}]}var P=z,A=e=>(typeof e.clear=="function"||(e.clear=()=>{let n;for(;n=e.key(0);)e.removeItem(n)}),e),O=["domain","expires","path","secure","httpOnly","maxAge","sameSite"];function T(e){if(!e)return"";let n="";for(const i in e){if(!O.includes(i))continue;const l=e[i];n+=l instanceof Date?`; ${i}=${l.toUTCString()}`:typeof l=="boolean"?`; ${i}`:`; ${i}=${l}`}return n}function D(e,n){return e.match(`(^|;)\\s*${n}\\s*=\\s*([^;]+)`)?.pop()??null}var $;try{$=b("solid-start/server").useRequest}catch{$=()=>(console.warn("It seems you attempt to use cookieStorage on the server without having solid-start installed or use vite."),{request:{headers:{get:()=>""}}})}var g=A({_read:()=>document.cookie,_write:(e,n,i)=>{document.cookie=`${e}=${n}${T(i)}`},getItem:(e,n)=>D(g._read(n),e),setItem:(e,n,i)=>{g._write(e,n,i);{const c=Object.assign(new Event("storage"),{key:e,oldValue:null,newValue:n,url:globalThis.document.URL,storageArea:g});window.dispatchEvent(c)}},removeItem:(e,n)=>{g._write(e,"deleted",{...n,expires:new Date(0)})},key:(e,n)=>{let i=null,l=0;return g._read(n).replace(/(?:^|;)\s*(.+?)\s*=\s*[^;]+/g,(c,u)=>(!i&&u&&l++===e&&(i=u),"")),i},getLength:e=>{let n=0;return g._read(e).replace(/(?:^|;)\s*.+?\s*=\s*[^;]+/g,i=>(n+=i?1:0,"")),n},get length(){return this.getLength()}});const E=P(),w=V(E);function M(e){return C(w.Provider,{value:E,get children(){return e.children}})}function R(){return _(w)}export{M as L,R as u};
