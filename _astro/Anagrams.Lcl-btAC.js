import{c as f,a as _,u as S,b as Y,d as Z,o as U,e as F,g as p,i as v,f as E,h as Q,r as B,t as b,j as k,k as I,s as R,l as ee,F as te}from"./web.Cdr1opmF.js";import{l as ne}from"./index.CqLtHk69.js";var re={equals:!1},ae=e=>typeof e=="function"&&!e.length?e():e;function oe(e,...t){return typeof e=="function"?e(...t):e}var se=(e,t)=>e.length>0?()=>e(S(t)):e;function ce(e,t){let a=0;const n=e.map((o,r)=>_(()=>(a=r,o()),void 0,re));return _(()=>n.map(o=>o())[a],void 0,t)}function le(e,t,a){let n=()=>t;const[o,r]=f(t),c=_(se(e,()=>n()),t);return[n=ce([o,c],a),m=>r(()=>typeof m=="function"?m(S(n)):m)]}var C=(e,t,a)=>{const n=a(e,t);return U(()=>clearInterval(n))},ie=(e,t,a)=>{if(typeof t=="number"){C(e,t,a);return}let n=!1,o=performance.now(),r=0,c=!1;const m=()=>{S(e),o=performance.now(),n=a===setTimeout};Z(d=>{if(n)return;const g=t();if(g===!1)return d&&(r+=(performance.now()-o)/d),g;if(d===!1&&(o=performance.now()),c){if(d&&(r+=(performance.now()-o)/d),o=performance.now(),r>=1)r=0,m();else if(r>0){const[h,T]=f(void 0,{equals:!1});return h(),C(()=>{r=0,c=!1,T(),m()},(1-r)*g,setTimeout),g}}return c=!0,C(m,g,a),g})};function de(e,t,a,n){const[o,r]=f(S(e.bind(void 0,a)),n),c=()=>r(e);return ie(c,t,setInterval),Y(c),o}var G=6e4,A=36e5,M=e=>e instanceof Date?e:new Date(e),ue=(e,t)=>t.getTime()-e.getTime(),O=e=>{const[t,a]=le(()=>M(ae(e)));return[t,o=>a(r=>M(oe(o,r)))]};function fe(e=G/2){const[t,a]=f(void 0,{equals:!1});return[de(()=>(t(),new Date),e,void 0,{equals:(o,r)=>o.getTime()===r.getTime()}),a]}function me(e,t){const[a]=O(e),[n]=O(t);return[_(()=>ue(a(),n())),{from:a,to:n}]}function ge(e,t=a=>Math.abs(a)<=A?G/2:A/2){const a=typeof t=="function"?()=>t(r()):t,[n,o]=fe(a),[r,{to:c}]=me(n,e);return[r,{update:o,target:c,now:n}]}var pe=(e,t,a=[])=>{const n=new WebSocket(e,t),o=n.send.bind(n);return n.send=r=>n.readyState==1?o(r):a.push(r),n.addEventListener("open",()=>{for(;a.length;)o(a.shift())}),n},ve=b("<button>");function be(e){return(()=>{var t=p(ve);return t.$$click=()=>e.onClick?.(),v(t,()=>e.children),E(()=>Q(t,`w-full rounded-lg border-[3px] border-[#CF5C36] px-2 py-1
        font-semibold transition duration-100 hover:bg-[#CF5C36]
        hover:text-white active:scale-95 ${e.class??""}`)),B(),t})()}F(["click"]);var he=b("<label for=server-url class=select-none>Server URL (Connection:<!$><!/>)"),_e=b('<input id=server-url type=text class="w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),$e=b('<div class="mb-2 flex flex-col items-center rounded-lg bg-slate-100 p-2 dark:bg-slate-700"><p class="font-mono text-sm font-bold"><!$><!/> - <!$><!/></p><code class=text-4xl>'),we=b('<div class="h-60 overflow-y-auto whitespace-pre-wrap break-all rounded-lg bg-slate-200 p-2 dark:bg-slate-700 sm:h-96">'),Se=b('<input type=text placeholder="message/answer here, send with Enter"class="mt-2 w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),Te=b("<div>");function Ce(){const[e,t]=ne,a=()=>e["anagrams-server-url"]??"wss://wordgames4j.azurewebsites.net/ws/anagram/1",[n,o]=f("Not Connected");let r,c;U(()=>{r&&r.close()});const[m,d]=f("WAITING ROUND START!"),[g,h]=f(""),[T,$]=f(""),[N]=ge(T,()=>100),[w,D]=f(""),[H,y]=f([]),L=s=>{const{type:l,content:i}=JSON.parse(s.data);switch(l){case"ChatMessage":y(u=>[...u,i]),setTimeout(()=>{c&&(c.scrollTop=c.scrollHeight)});break;case"OngoingRoundInfo":$(i.round_finish_time),d("PLEASE GUESS!"),h(i.word_to_guess);break;case"FinishedRoundInfo":$(i.to_next_round_time),d("TIME'S UP! THE ANSWER:"),h(i.word_answer);break;case"FinishedGame":$(""),d("WAITING ROUND START!"),h("")}},W=()=>{o("Open")},P=()=>{n()==="Not Connected"||n()==="Closed"?(r=pe(a()),o("Connecting"),r.addEventListener("open",W),r.addEventListener("message",L)):(o("Closing"),r?.removeEventListener("open",W),r?.removeEventListener("message",L),r?.close(),o("Closed"),$(""),d("WAITING ROUND START!"),h(""))},q=s=>{s.key==="Enter"&&(w()==="/clear"?y([]):w().trim()!==""&&r?.send(w()),D(""))};return[(()=>{var s=p(he),l=s.firstChild,i=l.nextSibling,[u,x]=k(i.nextSibling);return u.nextSibling,v(s,n,u,x),s})(),(()=>{var s=p(_e);return s.addEventListener("change",l=>t("anagrams-server-url",l.currentTarget.value)),E(()=>R(s,"value",a())),s})(),I(be,{class:"my-2",onClick:P,get children(){return typeof n<"u"&&n()==="Open"?"Disconnect":"Connect"}}),(()=>{var s=p($e),l=s.firstChild,i=l.firstChild,[u,x]=k(i.nextSibling),j=u.nextSibling,z=j.nextSibling,[J,K]=k(z.nextSibling),V=l.nextSibling;return v(l,m,u,x),v(l,(()=>{var X=_(()=>!!isNaN(N()));return()=>X()?"":`${Math.max(0,N()/1e3).toFixed(1)} secs`})(),J,K),v(V,g),s})(),(()=>{var s=p(we),l=c;return typeof l=="function"?ee(l,s):c=s,v(s,I(te,{get each(){return H()},children:i=>(()=>{var u=p(Te);return v(u,i),u})()})),s})(),(()=>{var s=p(Se);return s.addEventListener("change",l=>D(l.currentTarget.value)),s.$$keyup=q,E(()=>R(s,"value",w())),B(),s})()]}F(["keyup"]);export{Ce as default};
