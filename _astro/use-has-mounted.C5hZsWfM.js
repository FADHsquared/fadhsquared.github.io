import{c as h,q as E,o as y}from"./web.Cdr1opmF.js";var _=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,s)=>(typeof require<"u"?require:n)[s]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function x(e){const[n,s]=h(),l=e?.throw?(t,r)=>{throw s(t instanceof Error?t:new Error(r)),t}:(t,r)=>{s(t instanceof Error?t:new Error(r))},c=e?.api?Array.isArray(e.api)?e.api:[e.api]:[globalThis.localStorage].filter(Boolean),u=e?.prefix?`${e.prefix}.`:"",m=new Map,w=new Proxy({},{get(t,r){let a=m.get(r);a||(a=h(void 0,{equals:!1}),m.set(r,a)),a[0]();const o=c.reduce((i,f)=>{if(i!==null||!f)return i;try{return f.getItem(`${u}${r}`)}catch(g){return l(g,`Error reading ${u}${r} from ${f.name}`),null}},null);return o!==null&&e?.deserializer?e.deserializer(o,r,e.options):o}}),v=(t,r,a)=>{const o=e?.serializer?e.serializer(r,t,a??e.options):r,i=`${u}${t}`;c.forEach(g=>{try{g.getItem(i)!==o&&g.setItem(i,o)}catch(S){l(S,`Error setting ${u}${t} to ${o} in ${g.name}`)}});const f=m.get(t);f&&f[1]()},q=t=>c.forEach(r=>{try{r.removeItem(`${u}${t}`)}catch(a){l(a,`Error removing ${u}${t} from ${r.name}`)}}),I=()=>c.forEach(t=>{try{t.clear()}catch(r){l(r,`Error clearing ${t.name}`)}}),k=()=>{const t={},r=(a,o)=>{if(!t.hasOwnProperty(a)){const i=o&&e?.deserializer?e.deserializer(o,a,e.options):o;i&&(t[a]=i)}};return c.forEach(a=>{if(typeof a.getAll=="function"){let o;try{o=a.getAll()}catch(i){l(i,`Error getting all values from in ${a.name}`)}for(const i of o)r(i,o[i])}else{let o=0,i;try{for(;i=a.key(o++);)t.hasOwnProperty(i)||r(i,a.getItem(i))}catch(f){l(f,`Error getting all values from ${a.name}`)}}}),t};return e?.sync!==!1&&E(()=>{const t=r=>{let a=!1;c.forEach(o=>{try{o!==r.storageArea&&r.key&&r.newValue!==o.getItem(r.key)&&(r.newValue?o.setItem(r.key,r.newValue):o.removeItem(r.key),a=!0)}catch(i){l(i,`Error synching api ${o.name} from storage event (${r.key}=${r.newValue})`)}}),a&&r.key&&m.get(r.key)?.[1]()};"addEventListener"in globalThis?(globalThis.addEventListener("storage",t),y(()=>globalThis.removeEventListener("storage",t))):(c.forEach(r=>r.addEventListener?.("storage",t)),y(()=>c.forEach(r=>r.removeEventListener?.("storage",t))))}),[w,v,{clear:I,error:n,remove:q,toJSON:k}]}var V=x,L=e=>(typeof e.clear=="function"||(e.clear=()=>{let n;for(;n=e.key(0);)e.removeItem(n)}),e),z=["domain","expires","path","secure","httpOnly","maxAge","sameSite"];function b(e){if(!e)return"";let n="";for(const s in e){if(!z.includes(s))continue;const l=e[s];n+=l instanceof Date?`; ${s}=${l.toUTCString()}`:typeof l=="boolean"?`; ${s}`:`; ${s}=${l}`}return n}function A(e,n){return e.match(`(^|;)\\s*${n}\\s*=\\s*([^;]+)`)?.pop()??null}var $;try{$=_("solid-start/server").useRequest}catch{$=()=>(console.warn("It seems you attempt to use cookieStorage on the server without having solid-start installed or use vite."),{request:{headers:{get:()=>""}}})}var d=L({_read:()=>document.cookie,_write:(e,n,s)=>{document.cookie=`${e}=${n}${b(s)}`},getItem:(e,n)=>A(d._read(n),e),setItem:(e,n,s)=>{d._write(e,n,s);{const c=Object.assign(new Event("storage"),{key:e,oldValue:null,newValue:n,url:globalThis.document.URL,storageArea:d});window.dispatchEvent(c)}},removeItem:(e,n)=>{d._write(e,"deleted",{...n,expires:new Date(0)})},key:(e,n)=>{let s=null,l=0;return d._read(n).replace(/(?:^|;)\s*(.+?)\s*=\s*[^;]+/g,(c,u)=>(!s&&u&&l++===e&&(s=u),"")),s},getLength:e=>{let n=0;return d._read(e).replace(/(?:^|;)\s*.+?\s*=\s*[^;]+/g,s=>(n+=s?1:0,"")),n},get length(){return this.getLength()}});const M=V();function P(){const[e,n]=h(!1);return E(()=>{n(!0)}),e}export{M as l,P as u};
