<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>FADHsquared</title>

    <meta
      name="description"
      content="Currently full of placeholders but you can come and have a look!"
    />
    <meta name="keywords" content="downloads, fadh, portfolio" />

    <link rel="stylesheet" href="css/tailwind.css" />
    <link rel="stylesheet" href="css/master.css" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
      rel="stylesheet"
    />
    <style>
      /* Hero header */
      header {
        height: calc(100vh - 3.5rem);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-end;
        color: white;
        text-align: center;
      }
    </style>
  </head>
  <body class="bg-white dark:bg-gray-800">
    <!-- Hero header -->
    <header>
      <div class="w-full justify-self-start flex justify-between select-none">
        <button
          class="
            ml-3
            px-2
            pb-4
            text-yellow-400
            overflow-hidden
            no-underline
            text-7xl
            transition-all
            hover:bg-gray-50 hover:bg-opacity-20
            rounded
            filter
            drop-shadow
          "
          onclick="cycleHeader('prev')"
        >
          &lsaquo;
        </button>
        <button
          class="
            mr-3
            px-2
            pb-4
            text-yellow-400
            overflow-hidden
            no-underline
            text-7xl
            transition-all
            hover:bg-gray-50 hover:bg-opacity-20
            rounded
            filter
            drop-shadow
          "
          onclick="cycleHeader('next')"
        >
          &rsaquo;
        </button>
      </div>
      <div class="mt-14 mx-2 p-3 rounded bg-black bg-opacity-60 backdrop-filter backdrop-blur-md">
        <h1 class="text-3xl uppercase" id="header-title">Header Title</h1>
        <p class="mt-2">
          <span id="header-description">Header Description</span>
          <a id="header-link" class="underline" href="#" target="_blank">Read article...</a>
        </p>
      </div>
      <div id="header-radio-button-group" class="table my-3 select-none">
        <input class="mx-1 filter grayscale" type="radio" name="header-radio-button" />
      </div>
      <img
        id="header-image"
        class="fixed top-0 w-screen h-screen object-cover select-none z-[-10]"
        title="Header image"
      />
    </header>
    <nav
      class="
        sticky
        top-0
        h-14
        sm:w-max
        sm:m-auto
        flex
        justify-between
        items-center
        bg-gray-50 bg-opacity-90
        dark:bg-gray-900 dark:bg-opacity-90
        text-black
        dark:text-white
        sm:rounded
        shadow
        backdrop-filter backdrop-blur
      "
    >
      <div class="flex items-center flex-wrap">
        <a class="w-14 h-14" href="#"
          ><img
            class="w-14 h-14 sm:rounded-l"
            src="resources/images/fadhsquared-logo.png"
            alt="FADHsquared logo"
        /></a>
        <a class="ml-6 no-underline hover:underline" href="html/second-site-test.html">Updates</a>
        <a class="ml-6 no-underline hover:underline" href="#">Downloads</a>
        <a class="ml-6 no-underline hover:underline" href="#">Misc.</a>
      </div>
      <button class="h-6 mx-4 border-none active:text-gray-500" onclick="toggleDarkMode()">
        <span class="material-icons-outlined text-2xl">dark_mode</span>
      </button>
    </nav>
    <main class="p-4 bg-white dark:bg-gray-800 dark:text-gray-200">
      <!-- VSCode pro tip for IntelliJ look -->
      <section>
        <h2 class="text-center text-2xl">Pro tip: IntelliJ editor look in VS Code</h2>
        <div class="w-8 h-1 mx-auto mt-2 rounded-sm bg-black dark:bg-gray-200"></div>
        <div class="flex flex-wrap justify-center">
          <embed
            src="html/fake-windows/font-size-13.html"
            type="text/html"
            width="484px"
            height="257px"
          />
          <embed
            src="html/fake-windows/font-size-13.5.html"
            type="text/html"
            width="484px"
            height="257px"
          />
          <embed
            src="html/fake-windows/font-size-14.html"
            type="text/html"
            width="484px"
            height="257px"
          />
        </div>
      </section>
      <!-- Latest videos section -->
      <section class="min-w-0 overflow-x-auto">
        <h2 class="text-center text-2xl">Latest Videos</h2>
        <div class="w-8 h-1 mx-auto my-2 rounded-sm bg-black dark:bg-gray-200"></div>
        <div
          class="
            thumbnail-info-group
            my-2
            flex
            rounded
            hover:bg-gray-50
            dark:hover:bg-gray-900
            hover:shadow
          "
        >
          <img
            class="mr-2 w-[128px] h-[72px] min-w-[128px] min-h-[72px] object-cover"
            alt="thumbnail"
          />
          <div>
            <a href="#" target="_blank"
              ><h3 class="text-lg font-bold hover:underline active:text-gray-500">
                Video Title
              </h3></a
            >
            <p class="text-justify">Video Description</p>
          </div>
        </div>
      </section>
    </main>
    <script>
      // Comment structure: Comments describe code below them.
      "use strict";
      const body = document.body;
      // Reusable functions
      function duplicateElement(sourceElement, duplicateCount) {
        for (let index = 1; index <= duplicateCount; index++) {
          sourceElement.parentNode.appendChild(sourceElement.cloneNode(true));
        }
      }

      /* Function for switching the hero header image (animated with a smooth transition), title and description.
      Bound to radio buttons at the bottom of the header. */
      const headerCycleRadioButtons = document
        .getElementById("header-radio-button-group")
        .getElementsByTagName("input");
      let headerElement = document.getElementById("header-image");
      let currentHeaderNumber;
      let animationIsOngoing = false;
      function switchHeader(headerNumber, animationDuration = 250) {
        // Fix NaN header image number stored in sessionStorage on webpage first load
        if (isNaN(headerNumber)) {
          headerNumber = 0;
        }
        if (animationIsOngoing) {
          headerCycleRadioButtons[currentHeaderNumber].checked = true;
        } else if (headerNumber != currentHeaderNumber) {
          currentHeaderNumber = headerNumber;
          headerCycleRadioButtons[headerNumber].checked = true;
          // Switch title and description
          fetch("resources/header-text.json")
            .then((response) => response.json())
            .then((headerTextObject) => {
              document.getElementById("header-title").textContent =
                headerTextObject[headerNumber].title;
              document.getElementById("header-description").textContent =
                headerTextObject[headerNumber].description;
              document.getElementById("header-link").href =
                headerTextObject[headerNumber].articleURL;
            });
          // Switch header image
          const headerImage = headerImages[headerNumber];
          body.getElementsByTagName("header")[0].appendChild(headerImage);
          animationIsOngoing = true;
          headerImage.animate(
            {
              opacity: [0, 1],
              easing: ["ease-out"],
            },
            animationDuration
          );
          setTimeout(function () {
            headerElement.parentNode.removeChild(headerElement);
            headerElement = document.getElementById("header-image");
            animationIsOngoing = false;
          }, animationDuration);
          sessionStorage.currentHeaderImage = String(headerNumber);
        }
      }
      // Preload images for hero header, adding radio buttons as much as needed
      const headerImages = [];
      fetch("resources/header-text.json")
        .then((response) => response.json())
        .then((headerTextObject) => {
          duplicateElement(headerCycleRadioButtons[0], headerTextObject.length - 1);
          for (let index = 0; index < headerTextObject.length; index++) {
            headerImages[index] = headerElement.cloneNode(true);
            headerImages[index].src = headerTextObject[index].imageURL;
            headerCycleRadioButtons[index].addEventListener("click", function () {
              switchHeader(index);
            });
          }
          switchHeader(parseInt(sessionStorage.currentHeaderImage), 0);
        });
      /* Function for cycling to the previous or the next hero header image, title and description.
      Bound to next and previous buttons above the header title.
      Calls the switchHeader function above. */
      function cycleHeader(cycleTo) {
        const maxHeaderNumber = headerCycleRadioButtons.length - 1;
        let headerNumber = currentHeaderNumber;
        switch (cycleTo) {
          case "next":
            headerNumber += 1;
            break;
          case "prev":
            headerNumber -= 1;
            break;
        }
        if (headerNumber > maxHeaderNumber) {
          headerNumber = 0;
        } else if (headerNumber < 0) {
          headerNumber = maxHeaderNumber;
        }
        switchHeader(headerNumber);
      }
      // Grabbing & displaying latest published videos from the YouTube channel
      const thumbnailInfoGroup = body.getElementsByClassName("thumbnail-info-group");
      fetch(
        "https://api.allorigins.win/raw?url=https://www.youtube.com/feeds/videos.xml?channel_id=UCkIkjfzUY-32W9K5L56p9jA"
      )
        .then((response) => response.text())
        .then((text) => new DOMParser().parseFromString(text, "text/xml"))
        .then((youtubeFeedXml) => {
          const youtubeFeedEntry = youtubeFeedXml.getElementsByTagName("entry");
          // Duplicate the thumbnail-info-group div as much as needed
          duplicateElement(thumbnailInfoGroup[0], youtubeFeedEntry.length - 1);
          for (let index = 0; index < thumbnailInfoGroup.length; index++) {
            // Replace title
            thumbnailInfoGroup[index].getElementsByTagName("h3")[0].innerText =
              youtubeFeedEntry[index].getElementsByTagName("title")[0].textContent;
            // Replace description
            thumbnailInfoGroup[index].getElementsByTagName("p")[0].innerText =
              youtubeFeedEntry[index].getElementsByTagName("media:description")[0].textContent;
            // Replace link
            thumbnailInfoGroup[index].getElementsByTagName("a")[0].href = youtubeFeedEntry[index]
              .getElementsByTagName("link")[0]
              .getAttribute("href");
            // Replace thumbnail
            thumbnailInfoGroup[index].getElementsByTagName("img")[0].src = youtubeFeedEntry[index]
              .getElementsByTagName("media:thumbnail")[0]
              .getAttribute("url");
          }
        });
    </script>
    <script src="js/main.js"></script>
  </body>
</html>
