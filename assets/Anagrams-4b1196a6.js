import{d as p,h as $,u as S,p as z,q as J,v as O,k as V,c as k,g as h,a as y,i as b,b as R,F as X,r as Z,t as v,w as Q,l as ee}from"./entry-client-f4fb8dc3.js";import{S as te}from"./SectionContainer-1fb6ca0d.js";import{B as ne}from"./Button-8a3d77dd.js";var re=e=>typeof e=="function"&&!e.length?e():e;function ae(e,...t){return typeof e=="function"?e(...t):e}var oe=(e,t)=>e.length>0?()=>e(S(t)):e;function se(e,t){let a=0;const n=e.map((o,r)=>$(()=>(a=r,o())));return $(()=>n.map(o=>o())[a],void 0,t)}function ce(e,t,a){let n=()=>t;const[o,r]=p(t),s=$(oe(e,()=>n()),t);return[n=se([o,s],a),l=>r(()=>typeof l=="function"?l(S(n)):l)]}var D=(e,t,a)=>{const n=a(e,t);return O(()=>clearInterval(n))},ie=(e,t,a)=>{if(typeof t=="number"){D(e,t,a);return}let n=!1,o=performance.now(),r=0,s=!1;const l=()=>{S(e),o=performance.now(),n=a===setTimeout};J(i=>{if(n)return;const u=t();if(u===!1)return i&&(r+=(performance.now()-o)/i),u;if(i===!1&&(o=performance.now()),s){if(i&&(r+=(performance.now()-o)/i),o=performance.now(),r>=1)r=0,l();else if(r>0){const[f,x]=p(void 0,{equals:!1});return f(),D(()=>{r=0,s=!1,x(),l()},(1-r)*u,setTimeout),u}}return s=!0,D(l,u,a),u})};function le(e,t,a,n){const[o,r]=p(S(e.bind(void 0,a)),n),s=()=>r(e);return ie(s,t,setInterval),z(s),o}var ue=1e3,_=6e4,N=36e5,me=864e5,de=6048e5,fe=2592e6,ge=31536e6,pe=[{max:6e4,value:ue,name:"second"},{max:276e4,value:_,name:"minute"},{max:72e6,value:N,name:"hour"},{max:5184e5,value:me,name:"day"},{max:24192e5,value:de,name:"week"},{max:28512e6,value:fe,name:"month"},{max:1/0,value:ge,name:"year"}],U={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,t)=>e===1?t?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,t)=>e===1?t?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,t)=>e===1?t?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,t)=>e===1?t?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`},W=e=>e instanceof Date?e:new Date(e),he=(e,t)=>t.getTime()-e.getTime(),ve=e=>e.toISOString().slice(0,10);function we(e,t){const a={...U,...t},n=Math.abs(e);for(const s of pe)if(n<s.max)return r(s);return a.justNow;function o(s,l,i){const u=a[s];return typeof u=="function"?u(l,i):u.replace("{0}",l.toString())}function r(s){const l=Math.round(n/s.value),i=e<0,u=o(s.name,l,i);return o(i?"past":"future",u,i)}}var L=e=>{const[t,a]=ce(()=>W(re(e)));return[t,o=>a(r=>W(ae(o,r)))]};function be(e=_/2){const[t,a]=p(void 0,{equals:!1});return[le(()=>(t(),new Date),e,void 0,{equals:(o,r)=>o.getTime()===r.getTime()}),a]}function $e(e,t){const[a]=L(e),[n]=L(t);return[$(()=>he(a(),n())),{from:a,to:n}]}function xe(e,t=a=>Math.abs(a)<=N?_/2:N/2){const a=typeof t=="function"?()=>t(r()):t,[n,o]=be(a),[r,{to:s}]=$e(n,e);return[r,{update:o,target:s,now:n}]}function Se(e,t={}){const{min:a=_,max:n=1/0,dateFormatter:o=ve,messages:r,relativeFormatter:s=(f,x,w)=>we(w,r)}=t,[l,i]=xe(e,t.interval);return[$(()=>{const f=Math.abs(l());return f<a?r?.justNow??U.justNow:f>n?o(i.target()):s(i.now(),i.target(),l())}),{...i,difference:l}]}var _e=(e,t,a=[])=>{const n=new WebSocket(e,t),o=n.send.bind(n);return n.send=r=>n.readyState==1?o(r):a.push(r),n.addEventListener("open",()=>{for(;a.length;)o(a.shift())}),n};const Te=v("<p>Server URL: (Connection: <!#><!/>)"),Ee=v('<input type="text" class="w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),ke=v('<div class="mb-2 flex flex-col items-center rounded-lg bg-slate-100 p-2 dark:bg-slate-700"><p class="text-sm font-bold"><!#><!/> - <!#><!/></p><code class="text-4xl">'),ye=v('<div class="h-60 overflow-y-auto whitespace-pre-wrap break-all rounded-lg bg-slate-200 p-2 dark:bg-slate-700 sm:h-96">'),De=v('<input type="text" placeholder="message/answer here, send with Enter" class="mt-2 w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),Ne=v('<p class="text-center">...or download native client <a href="https://github.com/PixelSam123/wordgames-client/releases" class="font-bold underline">here'),Ce=v("<div>");function Re(){const[e,t]=V(),a=()=>e["anagrams-server-url"]??"wss://wordgames4j.azurewebsites.net/ws/anagram/1",[n,o]=p("Not Connected");let r,s;O(()=>{r&&r.close()});const[l,i]=p("WAITING ROUND START!"),[u,f]=p(""),[x,w]=p(""),[F]=Se(x),[T,C]=p(""),[G,A]=p([]),M=c=>{const{type:m,content:d}=JSON.parse(c.data);switch(m){case"ChatMessage":A(g=>[...g,d]),setTimeout(()=>{s&&(s.scrollTop=s.scrollHeight)});break;case"OngoingRoundInfo":w(d.round_finish_time),i("PLEASE GUESS!"),f(d.word_to_guess);break;case"FinishedRoundInfo":w(d.to_next_round_time),i("TIME'S UP! THE ANSWER:"),f(d.word_answer);break;case"FinishedGame":w(""),i("WAITING ROUND START!"),f("")}},I=()=>{o("Open")},B=()=>{n()==="Not Connected"||n()==="Closed"?(r=_e(a()),o("Connecting"),r.addEventListener("open",I),r.addEventListener("message",M)):(o("Closing"),r?.removeEventListener("open",I),r?.removeEventListener("message",M),r?.close(),o("Closed"),w(""),i("WAITING ROUND START!"),f(""))},H=c=>{c.key==="Enter"&&(T()==="/clear"?A([]):r?.send(T()),C(""))};return[k(te,{title:"ANAGRAMS",class:"mt-6 max-w-screen-sm self-center",get children(){return[(()=>{const c=h(Te),m=c.firstChild,d=m.nextSibling,[g,E]=y(d.nextSibling);return g.nextSibling,b(c,()=>typeof n>"u"?"Not Connected":n(),g,E),c})(),(()=>{const c=h(Ee);return c.addEventListener("change",m=>t("anagrams-server-url",m.currentTarget.value)),R(()=>c.value=a()),c})(),k(ne,{class:"my-2",onClick:B,get children(){return typeof n<"u"&&n()==="Open"?"Disconnect":"Connect"}}),(()=>{const c=h(ke),m=c.firstChild,d=m.firstChild,[g,E]=y(d.nextSibling),j=g.nextSibling,P=j.nextSibling,[q,K]=y(P.nextSibling),Y=m.nextSibling;return b(m,l,g,E),b(m,F,q,K),b(Y,u),c})(),(()=>{const c=h(ye),m=s;return typeof m=="function"?Q(m,c):s=c,b(c,k(X,{get each(){return G()},children:d=>(()=>{const g=h(Ce);return b(g,d),g})()})),c})(),(()=>{const c=h(De);return c.addEventListener("change",m=>C(m.currentTarget.value)),c.$$keyup=H,R(()=>c.value=T()),Z(),c})()]}}),h(Ne)]}ee(["keyup"]);export{Re as default};
