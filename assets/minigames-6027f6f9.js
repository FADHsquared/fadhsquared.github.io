import{j as m,e as w,o as x,p as K,k as V,q as I,c as h,g as p,t as b,u as X,f as k,h as S,a as L,F as Y,r as Z,l as Q,n as ee,T as te,M as ne}from"./entry-client-a55d42f8.js";import{S as re}from"./SectionContainer-15288b7f.js";import{B as se}from"./Button-d3619697.js";import{c as oe}from"./clientOnly-028cc6d2.js";var ae={equals:!1},ce=e=>typeof e=="function"&&!e.length?e():e;function le(e,...t){return typeof e=="function"?e(...t):e}var ie=(e,t)=>e.length>0?()=>e(x(t)):e;function de(e,t){let s=0;const n=e.map((o,r)=>w(()=>(s=r,o()),void 0,ae));return w(()=>n.map(o=>o())[s],void 0,t)}function fe(e,t,s){let n=()=>t;const[o,r]=m(t),c=w(ie(e,()=>n()),t);return[n=de([o,c],s),u=>r(()=>typeof u=="function"?u(x(n)):u)]}var C=(e,t,s)=>{const n=s(e,t);return I(()=>clearInterval(n))},me=(e,t,s)=>{if(typeof t=="number"){C(e,t,s);return}let n=!1,o=performance.now(),r=0,c=!1;const u=()=>{x(e),o=performance.now(),n=s===setTimeout};V(d=>{if(n)return;const g=t();if(g===!1)return d&&(r+=(performance.now()-o)/d),g;if(d===!1&&(o=performance.now()),c){if(d&&(r+=(performance.now()-o)/d),o=performance.now(),r>=1)r=0,u();else if(r>0){const[_,$]=m(void 0,{equals:!1});return _(),C(()=>{r=0,c=!1,$(),u()},(1-r)*g,setTimeout),g}}return c=!0,C(u,g,s),g})};function ue(e,t,s,n){const[o,r]=m(x(e.bind(void 0,s)),n),c=()=>r(e);return me(c,t,setInterval),K(c),o}var U=6e4,O=36e5,R=e=>e instanceof Date?e:new Date(e),ge=(e,t)=>t.getTime()-e.getTime(),W=e=>{const[t,s]=fe(()=>R(ce(e)));return[t,o=>s(r=>R(le(o,r)))]};function pe(e=U/2){const[t,s]=m(void 0,{equals:!1});return[ue(()=>(t(),new Date),e,void 0,{equals:(o,r)=>o.getTime()===r.getTime()}),s]}function he(e,t){const[s]=W(e),[n]=W(t);return[w(()=>ge(s(),n())),{from:s,to:n}]}function be(e,t=s=>Math.abs(s)<=O?U/2:O/2){const s=typeof t=="function"?()=>t(r()):t,[n,o]=pe(s),[r,{to:c}]=he(n,e);return[r,{update:o,target:c,now:n}]}var _e=(e,t,s=[])=>{const n=new WebSocket(e,t),o=n.send.bind(n);return n.send=r=>n.readyState==1?o(r):s.push(r),n.addEventListener("open",()=>{for(;s.length;)o(s.shift())}),n};const Se=b('<label for="server-url" class="select-none">Server URL (Connection:<!#><!/>)'),we=b('<input id="server-url" type="text" class="w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),ve=b('<div class="mb-2 flex flex-col items-center rounded-lg bg-slate-100 p-2 dark:bg-slate-700"><p class="font-mono text-sm font-bold"><!#><!/> - <!#><!/></p><code class="text-4xl">'),Te=b('<div class="h-60 overflow-y-auto whitespace-pre-wrap break-all rounded-lg bg-slate-200 p-2 dark:bg-slate-700 sm:h-96">'),xe=b('<input type="text" placeholder="message/answer here, send with Enter" class="mt-2 w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),$e=b("<div>"),Ee=b('<p class="text-center">...or download native client <a href="https://github.com/PixelSam123/wordgames-client/releases" class="font-bold underline">here'),ke=oe(async()=>({default(){const[e,t]=X(),s=()=>e["anagrams-server-url"]??"wss://wordgames4j.azurewebsites.net/ws/anagram/1",[n,o]=m("Not Connected");let r,c;I(()=>{r&&r.close()});const[u,d]=m("WAITING ROUND START!"),[g,_]=m(""),[$,v]=m(""),[N]=be($,()=>100),[T,y]=m(""),[B,D]=m([]),M=a=>{const{type:l,content:i}=JSON.parse(a.data);switch(l){case"ChatMessage":D(f=>[...f,i]),setTimeout(()=>{c&&(c.scrollTop=c.scrollHeight)});break;case"OngoingRoundInfo":v(i.round_finish_time),d("PLEASE GUESS!"),_(i.word_to_guess);break;case"FinishedRoundInfo":v(i.to_next_round_time),d("TIME'S UP! THE ANSWER:"),_(i.word_answer);break;case"FinishedGame":v(""),d("WAITING ROUND START!"),_("")}},A=()=>{o("Open")},G=()=>{n()==="Not Connected"||n()==="Closed"?(r=_e(s()),o("Connecting"),r.addEventListener("open",A),r.addEventListener("message",M)):(o("Closing"),r?.removeEventListener("open",A),r?.removeEventListener("message",M),r?.close(),o("Closed"),v(""),d("WAITING ROUND START!"),_(""))},P=a=>{a.key==="Enter"&&(T()==="/clear"?D([]):T().trim()!==""&&r?.send(T()),y(""))};return[(()=>{const a=p(Se),l=a.firstChild,i=l.nextSibling,[f,E]=k(i.nextSibling);return f.nextSibling,S(a,n,f,E),a})(),(()=>{const a=p(we);return a.addEventListener("change",l=>t("anagrams-server-url",l.currentTarget.value)),L(()=>a.value=s()),a})(),h(se,{class:"my-2",onClick:G,get children(){return typeof n<"u"&&n()==="Open"?"Disconnect":"Connect"}}),(()=>{const a=p(ve),l=a.firstChild,i=l.firstChild,[f,E]=k(i.nextSibling),F=f.nextSibling,H=F.nextSibling,[q,j]=k(H.nextSibling),z=l.nextSibling;return S(l,u,f,E),S(l,(()=>{const J=w(()=>!!isNaN(N()));return()=>J()?"":`${Math.max(0,N()/1e3).toFixed(1)} secs`})(),q,j),S(z,g),a})(),(()=>{const a=p(Te),l=c;return typeof l=="function"?ee(l,a):c=a,S(a,h(Y,{get each(){return B()},children:i=>(()=>{const f=p($e);return S(f,i),f})()})),a})(),(()=>{const a=p(xe);return a.addEventListener("change",l=>y(l.currentTarget.value)),a.$$keyup=P,L(()=>a.value=T()),Z(),a})()]}}));function Ce(){return[h(re,{title:"ANAGRAMS",class:"mt-6 min-h-[16rem] max-w-screen-sm self-center",get children(){return h(ke,{})}}),p(Ee)]}Q(["keyup"]);function Ae(){return[h(te,{children:"PixelSamz - Minigames"}),h(ne,{name:"description",content:"Play some in-browser multiplayer minigames!"}),h(Ce,{})]}export{Ae as default};
