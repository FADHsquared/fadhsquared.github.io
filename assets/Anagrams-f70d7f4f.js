import{d as u,h as w,u as v,p as K,q as V,v as U,k as X,c as k,g as p,a as E,i as _,b as A,F as Y,r as Z,t as h,w as Q,l as ee}from"./entry-client-d6fbe82d.js";import{S as te}from"./SectionContainer-cb0435ee.js";import{B as ne}from"./Button-9e0f12b2.js";var re=e=>typeof e=="function"&&!e.length?e():e;function se(e,...n){return typeof e=="function"?e(...n):e}var oe=(e,n)=>e.length>0?()=>e(v(n)):e;function ae(e,n){let s=0;const t=e.map((o,r)=>w(()=>(s=r,o())));return w(()=>t.map(o=>o())[s],void 0,n)}function ce(e,n,s){let t=()=>n;const[o,r]=u(n),c=w(oe(e,()=>t()),n);return[t=ae([o,c],s),m=>r(()=>typeof m=="function"?m(v(t)):m)]}var C=(e,n,s)=>{const t=s(e,n);return U(()=>clearInterval(t))},le=(e,n,s)=>{if(typeof n=="number"){C(e,n,s);return}let t=!1,o=performance.now(),r=0,c=!1;const m=()=>{v(e),o=performance.now(),t=s===setTimeout};V(d=>{if(t)return;const g=n();if(g===!1)return d&&(r+=(performance.now()-o)/d),g;if(d===!1&&(o=performance.now()),c){if(d&&(r+=(performance.now()-o)/d),o=performance.now(),r>=1)r=0,m();else if(r>0){const[b,$]=u(void 0,{equals:!1});return b(),C(()=>{r=0,c=!1,$(),m()},(1-r)*g,setTimeout),g}}return c=!0,C(m,g,s),g})};function ie(e,n,s,t){const[o,r]=u(v(e.bind(void 0,s)),t),c=()=>r(e);return le(c,n,setInterval),K(c),o}var O=6e4,L=36e5,M=e=>e instanceof Date?e:new Date(e),de=(e,n)=>n.getTime()-e.getTime(),I=e=>{const[n,s]=ce(()=>M(re(e)));return[n,o=>s(r=>M(se(o,r)))]};function fe(e=O/2){const[n,s]=u(void 0,{equals:!1});return[ie(()=>(n(),new Date),e,void 0,{equals:(o,r)=>o.getTime()===r.getTime()}),s]}function ue(e,n){const[s]=I(e),[t]=I(n);return[w(()=>de(s(),t())),{from:s,to:t}]}function me(e,n=s=>Math.abs(s)<=L?O/2:L/2){const s=typeof n=="function"?()=>n(r()):n,[t,o]=fe(s),[r,{to:c}]=ue(t,e);return[r,{update:o,target:c,now:t}]}var ge=(e,n,s=[])=>{const t=new WebSocket(e,n),o=t.send.bind(t);return t.send=r=>t.readyState==1?o(r):s.push(r),t.addEventListener("open",()=>{for(;s.length;)o(s.shift())}),t};const pe=h("<p>Server URL: (Connection: <!#><!/>)"),he=h('<input type="text" class="w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),be=h('<div class="mb-2 flex flex-col items-center rounded-lg bg-slate-100 p-2 dark:bg-slate-700"><p class="text-sm font-bold"><!#><!/> - <!#><!/></p><code class="text-4xl">'),_e=h('<div class="h-60 overflow-y-auto whitespace-pre-wrap break-all rounded-lg bg-slate-200 p-2 dark:bg-slate-700 sm:h-96">'),we=h('<input type="text" placeholder="message/answer here, send with Enter" class="mt-2 w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),Se=h('<p class="text-center">...or download native client <a href="https://github.com/PixelSam123/wordgames-client/releases" class="font-bold underline">here'),ve=h("<div>");function ke(){const[e,n]=X(),s=()=>e["anagrams-server-url"]??"wss://wordgames4j.azurewebsites.net/ws/anagram/1",[t,o]=u("Not Connected");let r,c;U(()=>{r&&r.close()});const[m,d]=u("WAITING ROUND START!"),[g,b]=u(""),[$,S]=u(""),[N]=me($,()=>500),[x,D]=u(""),[B,y]=u([]),R=a=>{const{type:l,content:i}=JSON.parse(a.data);switch(l){case"ChatMessage":y(f=>[...f,i]),setTimeout(()=>{c&&(c.scrollTop=c.scrollHeight)});break;case"OngoingRoundInfo":S(i.round_finish_time),d("PLEASE GUESS!"),b(i.word_to_guess);break;case"FinishedRoundInfo":S(i.to_next_round_time),d("TIME'S UP! THE ANSWER:"),b(i.word_answer);break;case"FinishedGame":S(""),d("WAITING ROUND START!"),b("")}},W=()=>{o("Open")},G=()=>{t()==="Not Connected"||t()==="Closed"?(r=ge(s()),o("Connecting"),r.addEventListener("open",W),r.addEventListener("message",R)):(o("Closing"),r?.removeEventListener("open",W),r?.removeEventListener("message",R),r?.close(),o("Closed"),S(""),d("WAITING ROUND START!"),b(""))},F=a=>{a.key==="Enter"&&(x()==="/clear"?y([]):r?.send(x()),D(""))};return[k(te,{title:"ANAGRAMS",class:"mt-6 max-w-screen-sm self-center",get children(){return[(()=>{const a=p(pe),l=a.firstChild,i=l.nextSibling,[f,T]=E(i.nextSibling);return f.nextSibling,_(a,()=>typeof t>"u"?"Not Connected":t(),f,T),a})(),(()=>{const a=p(he);return a.addEventListener("change",l=>n("anagrams-server-url",l.currentTarget.value)),A(()=>a.value=s()),a})(),k(ne,{class:"my-2",onClick:G,get children(){return typeof t<"u"&&t()==="Open"?"Disconnect":"Connect"}}),(()=>{const a=p(be),l=a.firstChild,i=l.firstChild,[f,T]=E(i.nextSibling),H=f.nextSibling,P=H.nextSibling,[q,j]=E(P.nextSibling),z=l.nextSibling;return _(l,m,f,T),_(l,(()=>{const J=w(()=>!!isNaN(N()));return()=>J()?"":`${Math.max(0,N()/1e3).toFixed(1)} seconds`})(),q,j),_(z,g),a})(),(()=>{const a=p(_e),l=c;return typeof l=="function"?Q(l,a):c=a,_(a,k(Y,{get each(){return B()},children:i=>(()=>{const f=p(ve);return _(f,i),f})()})),a})(),(()=>{const a=p(we);return a.addEventListener("change",l=>D(l.currentTarget.value)),a.$$keyup=F,A(()=>a.value=x()),Z(),a})()]}}),p(Se)]}ee(["keyup"]);export{ke as default};
