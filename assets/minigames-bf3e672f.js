import{h as m,d as S,n as T,o as K,j as V,p as O,c as h,g as p,t as b,u as X,e as E,f as w,a as W,F as Y,r as Z,k as Q,l as ee,T as te,M as ne}from"./entry-client-b385ce8d.js";import{S as re}from"./SectionContainer-e8be2e1b.js";import{B as se}from"./Button-8b51be64.js";import{c as oe}from"./clientOnly-0cc5dcd8.js";var ae=e=>typeof e=="function"&&!e.length?e():e;function ce(e,...t){return typeof e=="function"?e(...t):e}var le=(e,t)=>e.length>0?()=>e(T(t)):e;function ie(e,t){let s=0;const n=e.map((o,r)=>S(()=>(s=r,o())));return S(()=>n.map(o=>o())[s],void 0,t)}function de(e,t,s){let n=()=>t;const[o,r]=m(t),c=S(le(e,()=>n()),t);return[n=ie([o,c],s),u=>r(()=>typeof u=="function"?u(T(n)):u)]}var C=(e,t,s)=>{const n=s(e,t);return O(()=>clearInterval(n))},fe=(e,t,s)=>{if(typeof t=="number"){C(e,t,s);return}let n=!1,o=performance.now(),r=0,c=!1;const u=()=>{T(e),o=performance.now(),n=s===setTimeout};V(d=>{if(n)return;const g=t();if(g===!1)return d&&(r+=(performance.now()-o)/d),g;if(d===!1&&(o=performance.now()),c){if(d&&(r+=(performance.now()-o)/d),o=performance.now(),r>=1)r=0,u();else if(r>0){const[_,x]=m(void 0,{equals:!1});return _(),C(()=>{r=0,c=!1,x(),u()},(1-r)*g,setTimeout),g}}return c=!0,C(u,g,s),g})};function me(e,t,s,n){const[o,r]=m(T(e.bind(void 0,s)),n),c=()=>r(e);return fe(c,t,setInterval),K(c),o}var U=6e4,A=36e5,L=e=>e instanceof Date?e:new Date(e),ue=(e,t)=>t.getTime()-e.getTime(),I=e=>{const[t,s]=de(()=>L(ae(e)));return[t,o=>s(r=>L(ce(o,r)))]};function ge(e=U/2){const[t,s]=m(void 0,{equals:!1});return[me(()=>(t(),new Date),e,void 0,{equals:(o,r)=>o.getTime()===r.getTime()}),s]}function pe(e,t){const[s]=I(e),[n]=I(t);return[S(()=>ue(s(),n())),{from:s,to:n}]}function he(e,t=s=>Math.abs(s)<=A?U/2:A/2){const s=typeof t=="function"?()=>t(r()):t,[n,o]=ge(s),[r,{to:c}]=pe(n,e);return[r,{update:o,target:c,now:n}]}var be=(e,t,s=[])=>{const n=new WebSocket(e,t),o=n.send.bind(n);return n.send=r=>n.readyState==1?o(r):s.push(r),n.addEventListener("open",()=>{for(;s.length;)o(s.shift())}),n};const _e=b('<label for="server-url" class="select-none">Server URL (Connection:<!#><!/>)'),we=b('<input id="server-url" type="text" class="w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),Se=b('<div class="mb-2 flex flex-col items-center rounded-lg bg-slate-100 p-2 dark:bg-slate-700"><p class="font-mono text-sm font-bold"><!#><!/> - <!#><!/></p><code class="text-4xl">'),ve=b('<div class="h-60 overflow-y-auto whitespace-pre-wrap break-all rounded-lg bg-slate-200 p-2 dark:bg-slate-700 sm:h-96">'),Te=b('<input type="text" placeholder="message/answer here, send with Enter" class="mt-2 w-full rounded-lg border-2 border-slate-300 bg-transparent dark:border-slate-600">'),xe=b("<div>"),$e=b('<p class="text-center">...or download native client <a href="https://github.com/PixelSam123/wordgames-client/releases" class="font-bold underline">here'),ke=oe(async()=>({default(){const[e,t]=X(),s=()=>e["anagrams-server-url"]??"wss://wordgames4j.azurewebsites.net/ws/anagram/1",[n,o]=m("Not Connected");let r,c;O(()=>{r&&r.close()});const[u,d]=m("WAITING ROUND START!"),[g,_]=m(""),[x,v]=m(""),[y]=he(x,()=>100),[$,N]=m(""),[B,D]=m([]),M=a=>{const{type:l,content:i}=JSON.parse(a.data);switch(l){case"ChatMessage":D(f=>[...f,i]),setTimeout(()=>{c&&(c.scrollTop=c.scrollHeight)});break;case"OngoingRoundInfo":v(i.round_finish_time),d("PLEASE GUESS!"),_(i.word_to_guess);break;case"FinishedRoundInfo":v(i.to_next_round_time),d("TIME'S UP! THE ANSWER:"),_(i.word_answer);break;case"FinishedGame":v(""),d("WAITING ROUND START!"),_("")}},R=()=>{o("Open")},G=()=>{n()==="Not Connected"||n()==="Closed"?(r=be(s()),o("Connecting"),r.addEventListener("open",R),r.addEventListener("message",M)):(o("Closing"),r?.removeEventListener("open",R),r?.removeEventListener("message",M),r?.close(),o("Closed"),v(""),d("WAITING ROUND START!"),_(""))},P=a=>{a.key==="Enter"&&($()==="/clear"?D([]):r?.send($()),N(""))};return[(()=>{const a=p(_e),l=a.firstChild,i=l.nextSibling,[f,k]=E(i.nextSibling);return f.nextSibling,w(a,n,f,k),a})(),(()=>{const a=p(we);return a.addEventListener("change",l=>t("anagrams-server-url",l.currentTarget.value)),W(()=>a.value=s()),a})(),h(se,{class:"my-2",onClick:G,get children(){return typeof n<"u"&&n()==="Open"?"Disconnect":"Connect"}}),(()=>{const a=p(Se),l=a.firstChild,i=l.firstChild,[f,k]=E(i.nextSibling),F=f.nextSibling,H=F.nextSibling,[q,j]=E(H.nextSibling),z=l.nextSibling;return w(l,u,f,k),w(l,(()=>{const J=S(()=>!!isNaN(y()));return()=>J()?"":`${Math.max(0,y()/1e3).toFixed(1)} secs`})(),q,j),w(z,g),a})(),(()=>{const a=p(ve),l=c;return typeof l=="function"?ee(l,a):c=a,w(a,h(Y,{get each(){return B()},children:i=>(()=>{const f=p(xe);return w(f,i),f})()})),a})(),(()=>{const a=p(Te);return a.addEventListener("change",l=>N(l.currentTarget.value)),a.$$keyup=P,W(()=>a.value=$()),Z(),a})()]}}));function Ee(){return[h(re,{title:"ANAGRAMS",class:"mt-6 min-h-[16rem] max-w-screen-sm self-center",get children(){return h(ke,{})}}),p($e)]}Q(["keyup"]);function Me(){return[h(te,{children:"PixelSamz - Minigames"}),h(ne,{name:"description",content:"Play some in-browser multiplayer minigames!"}),h(Ee,{})]}export{Me as default};
